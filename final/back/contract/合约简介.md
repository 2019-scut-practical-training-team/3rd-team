# 合约简介

## Factory.sol

* 用于存放订单和宠物结构体

##  DataProcess.sol

* 存放两个函数：字符串拼接和整型转字符串

## Market.sol

* 函数及其注释如下

* ```js
  pragma solidity ^0.4.19;
  import "./Factory.sol";
  import "./DataProcess.sol";
  
  contract Market is DataProcess{
  
      //构造函数,设置合约部署人为管理员
      function Market() public 
  
      //修饰符，判断身份是不是管理员
      modifier isAdmin 
  
      //映射：
      //判断是否已创建过宠物
      mapping (address => int) createdPet;
      //地址与余额映射
      mapping (address => uint) Balance;
      //判断是否老用户
      mapping (address => int) oldUser;
      //用户地址到宠物列表的映射
      mapping (address => Factory.Pet[]) addressToPetList;
      //宠物id到用户地址的映射
      mapping (string => address) petIdToOwner;
  
  
  
      //内部调用函数：
      //初始化用户余额以及是否创建过宠物参数
      function initUser() private 
      
      //为用户配置一个宠物列表
      function setAddressToPetList() private 
      
      //设置宠物主人
      function setPetOwner(string _id,address _owner) private 
      
      //创建一个新订单，内部调用
      function createOrder(string _id, address _buyer, address _seller, string _time, string _petId, string _petPrice, int _status,string _result) private 
      
      //支付对应金额，内部调用
      function pay(address _from, address _to, uint _price) private 
      
      //转交宠物所有权，内部调用
      function changePetOwner(address _from, address _to, string _petId) private 
  
  
  
  
  
      //用户相关：
      //创建用户函数，初始化余额和是否创建过宠物参数
      function createUser() public 
      
      //获取调用者的余额
      function getBalanceOfMe() public view returns (uint) 
      
      //通过地址获取余额
      function getBalace(address _address) public view returns (uint) 
  
  
  
  
      //宠物相关：
      //返回用户对应的宠物列表
      function getPetListFromAddress() public view returns (string) 
      
      //展示所有在售宠物
      function showPetOnSell() public returns(string)
  
      //创建宠物，若没有创建过就先创建宠物列表再创建宠物
      function createPet(string _name, string _id, string _type, int _price, int _status, string _img, string _intro, address _owner) public 
      
      //购买宠物
      function buyPet(string _petId, uint _price, address _seller) public 
  
      //出售宠物
      function sellPet(string _petId) public 
      
      //取消出售宠物
      function cancelSellPet(string _petId) public 
      
      //修改宠物信息
      function changePetInfo(string _name, string _id, string _type, int _price, string _img, string _intro) public 
  
  
  
  
  
  
      //订单相关：
      //管理员部分：
      //返回所有订单（管理员查看
      function adminGetOrderList() public view isAdmin returns (string, address[], address[]) 
      
      //管理员获得请求仲裁的订单
      function adminGetReturnOrderList() public view isAdmin returns (string, address[], address[]) 
      
      //管理员接受退货申请
      function acceptReturn(string _orderId) public isAdmin 
      
      //管理员拒绝退货申请
      function rejectReturn(string _orderId) public isAdmin 
  
  
      //用户部分：
      //用户获得自己的订单列表
      function userGetOrderList() public view returns (string, address[], address[]) 
      
      //申请退货
      function applyForReturn(string _orderId) public 
  ```

  